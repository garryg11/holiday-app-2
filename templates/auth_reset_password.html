{% extends "layout.html" %}
{% block content %}
<div class="container mt-5">
  {% if token %}
    <h2>Reset Your Password</h2>
    <p>Please enter your new password.</p>
    <form method="POST" action="{{ url_for('auth.reset_password', token=token) }}" novalidate>
      <div class="mb-3">
        <label for="password" class="form-label">New Password <span class="text-danger">*</span></label>
        <input type="password" class="form-control" id="password" name="password" placeholder="Enter new password" required aria-required="true" minlength="6">
      </div>
      <div class="mb-3">
        <label for="confirm_password" class="form-label">Confirm New Password <span class="text-danger">*</span></label>
        <input type="password" class="form-control" id="confirm_password" name="confirm_password" placeholder="Confirm new password" required aria-required="true" minlength="6">
      </div>
      <button type="submit" class="btn btn-primary">Reset Password</button>
    </form>
  {% elif current_user.is_authenticated %}
    <h2>Change Your Password</h2>
    <form method="POST" action="{{ url_for('auth.reset_password') }}" novalidate>
      <div class="mb-3">
        <label for="current_password" class="form-label">Current Password <span class="text-danger">*</span></label>
        <input type="password" class="form-control" id="current_password" name="current_password" placeholder="Enter current password" required aria-required="true" minlength="6">
      </div>
      <div class="mb-3">
        <label for="new_password" class="form-label">New Password <span class="text-danger">*</span></label>
        <input type="password" class="form-control" id="new_password" name="new_password" placeholder="Enter new password" required aria-required="true" minlength="6">
      </div>
      <div class="mb-3">
        <label for="confirm_password" class="form-label">Confirm New Password <span class="text-danger">*</span></label>
        <input type="password" class="form-control" id="confirm_password" name="confirm_password" placeholder="Confirm new password" required aria-required="true" minlength="6">
      </div>
      <button type="submit" class="btn btn-primary">Update Password</button>
    </form>
  {% else %}
    <!-- Fallback content if needed -->
    <h2>Reset Password</h2>
    <p>Please check your email for a reset link.</p>
  {% endif %}
</div>
{% endblock %}
